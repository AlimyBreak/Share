clear;

A = [1,2,1;2,2,3;-1,-3,0];

[LL,UU,PP] = lu(A);

L(1,1) = 1;
L(1,2) = 0;
L(1,3) = 0;

L(2,1) = A(2,1)/A(1,1);
L(2,2) = 1;
L(2,3) = 0;


L(3,1) = A(3,1)/A(1,1);
L(3,2) = (A(3,2) - A(1,2)*A(3,1)/A(1,1)) /(A(2,2) - A(2,1)*A(1,2)/A(1,1));
L(3,3) = 1;


U(1,1) = A(1,1);
U(1,2) = A(1,2);
U(1,3) = A(1,3);


U(2,1) = 0;
U(2,2) = A(2,2) - A(2,1)*A(1,2)/A(1,1);
U(2,3) = A(2,3) - A(2,1)*A(1,3)/A(1,1);


U(3,1) = 0;
U(3,2) = 0;
U(3,3) = A(3,3) - A(3,1)*A(1,3)/A(1,1) - L(3,2)*U(2,3);

PP'*LL*UU-A
L*U - A

